# USWDS + EDS Integration Pattern

This document explains how USWDS (United States Web Design System) is integrated with Adobe Edge Delivery Services (EDS) in this project.

## Core Pattern: usa-prose for Default Content

### The Challenge

In EDS, content comes from Google Docs/Sheets and is rendered as plain HTML without custom classes on individual elements. Authors don't (and shouldn't have to) add classes to every heading, paragraph, and list item.

### The Solution: USWDS Prose Component

USWDS provides the [`usa-prose` component](https://designsystem.digital.gov/components/prose/) specifically for this use case:

> "usa-prose is meant for blocks of text where it's more difficult to add custom classes to individual elements, like a blog post where the content is coming out of markdown or a CMS."

**Perfect for EDS!**

### Implementation

All `.default-content-wrapper` elements automatically receive the `usa-prose` class in `/scripts/scripts.js`:

```javascript
// In decorateSections() function
wrapper.classList.add('default-content-wrapper', 'usa-prose');
```

This provides:
- ✅ Consistent USWDS typography for headings (h1-h6)
- ✅ Proper paragraph spacing
- ✅ List styling (ul, ol, nested lists)
- ✅ Table styling
- ✅ Optimal line length (75 characters max for readability)

## Block Components

### Custom Decorators

Each USWDS component (header, footer, card, hero, etc.) has a custom JavaScript decorator in `/blocks/{component}/{component}.js` that:

1. **Reads simple content** from the CMS (via EDS fragments or block authoring)
2. **Transforms it** into complex USWDS HTML structures
3. **Applies USWDS classes** for proper styling and behavior

Example: Card Block

**Author provides:**
```
- Heading
- Image
- Text
- Link
```

**Decorator transforms to:**
```html
<li class="usa-card tablet-lg:grid-col-6 widescreen:grid-col-4">
  <div class="usa-card__container">
    <div class="usa-card__header">
      <h3 class="usa-card__heading">...</h3>
    </div>
    <div class="usa-card__media">...</div>
    <div class="usa-card__body">...</div>
    <div class="usa-card__footer">...</div>
  </div>
</li>
```

### Protected from Build Process

All block JavaScript files are protected by `.buildignore` because they contain custom EDS logic, not USWDS code:

```
# In .buildignore
blocks/**/*.js
```

## CSS Structure

### USWDS Core Styles

`/styles/uswds-core.css` contains:
- All USWDS component styles
- Utility classes
- Typography (including `usa-prose`)
- Grid system

Generated by: `npm run build:uswds`

### Block CSS Files

Each block has a CSS file that contains:
1. **Custom EDS overrides** (at the top)
2. **USWDS component styles** (below, auto-generated)

**Protected CSS files** (have custom overrides):
- `blocks/card/card.css` - responsive grid utilities
- `blocks/header/header.css` - logo sizing, EDS wrapper fixes
- `blocks/hero/hero.css` - image positioning
- `blocks/banner/banner.css` - mobile hover fixes
- `blocks/footer/footer.css` - EDS wrapper fixes

Protected via `.buildignore` to preserve custom overrides.

## Content Authoring Patterns

### Default Content (Prose)

For running text, just write naturally in Google Docs:

```
# Heading
Paragraph text with automatic USWDS styling.
- List item
- List item
```

The `usa-prose` class handles all styling automatically.

### Component Blocks

For USWDS components, use block syntax:

```
Card
---
Heading
Image
Text
Call to action link
```

The decorator transforms this into proper USWDS card markup.

## Build Process

### Standard Build

```bash
npm run build:uswds
```

- Regenerates all CSS from USWDS Sass
- Skips protected files in `.buildignore`
- Preserves custom overrides

### Force Regeneration

```bash
npm run build:uswds -- --force --component=card
```

- Regenerates even protected files
- Useful for USWDS version updates
- Requires re-adding custom overrides afterward

See `USWDS-UPDATE-STRATEGY.md` for detailed update workflows.

## Key Benefits of This Pattern

1. **Author-friendly**: Content creators use familiar Google Docs, no HTML/CSS knowledge required
2. **USWDS-compliant**: All components follow official USWDS markup and styling
3. **Upgrade-safe**: Clear separation between custom EDS logic and USWDS generated code
4. **Performance**: No build-time compilation, CSS/JS delivered directly to browser
5. **Flexible**: Easy to add new USWDS components or customize existing ones

## File Organization

```
/blocks/
  {component}/
    {component}.js   # Custom EDS decorator (protected)
    {component}.css  # USWDS styles + optional overrides
    README.md        # Authoring guidelines

/scripts/
  scripts.js         # Applies usa-prose to default content
  build-uswds.js     # Generates CSS from USWDS Sass

/styles/
  uswds-core.css     # All USWDS component styles (auto-generated)
  styles.css         # Project-specific styles and variables

.buildignore         # Protects files from regeneration
uswds.config.js      # USWDS build configuration
```

## When to Use What

### Use `usa-prose` (default content) for:
- Blog posts
- Article content
- Documentation
- Any running text from the CMS

### Use Block Components for:
- Navigation (header, footer)
- Cards, collections
- Forms, alerts, modals
- Any USWDS component that needs specific markup

### Use Custom Blocks for:
- Project-specific functionality
- Complex interactive components
- Integrations with other services

## Questions?

- See `USWDS-UPDATE-STRATEGY.md` for updating USWDS
- See individual block `README.md` files for authoring guidelines
- Visit [USWDS documentation](https://designsystem.digital.gov/) for component details
